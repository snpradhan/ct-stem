{% load base_extras %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <title> {% block title %} {%endblock %} CT-STEM  </title>
    {% block media %}
      {% block bootstrap_css %}
        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">      <!-- Optional theme -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css">
      {% endblock %}

      {% block jquery %}
        <!-- jQuery library -->
        <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
        <link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
        <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
      {% endblock %}

      {% block datatable %}
        <!-- DataTables library -->
        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.10/css/jquery.dataTables.min.css"/>
        <script type="text/javascript" src="https://cdn.datatables.net/1.10.10/js/jquery.dataTables.min.js"></script>
      {% endblock %}

      {% block bootstrap_js %}
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
      {% endblock %}

      {% block django_admin %}
        <!-- admin widget for multi select -->
        <link rel="stylesheet" href="/static/css/django-admin-widgets.css"/>
        <script type="text/javascript" src="/static/js/django-admin.multiselect.js"></script>
        <script type="text/javascript" src="{% url 'admin:jsi18n' %}"></script>
      {% endblock %}

      {% block misc %}
        <link href="/static/css/monokai_sublime.css" rel="stylesheet">
        <script src="/static/js/highlight.pack.js"></script>
        <script src="http://canvasjs.com//assets/script/canvasjs.min.js"></script>
      {% endblock %}

      {% block fonts %}
        <link href="https://fonts.googleapis.com/css?family=Maitree:400,700|Roboto+Condensed:300,400,700italic" rel="stylesheet">
        <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
        <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
        <link href='https://fonts.googleapis.com/css?family=Kaushan+Script' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700' rel='stylesheet' type='text/css'>
      {% endblock %}

      {% block agency %}
        <link rel="stylesheet" href="/static/css/agency.css">
      {% endblock %}

      {% block google_analytics %}
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', '{% settings_value "GOOGLE_ANALYTICS_ID" %}', 'auto');
          ga('send', 'pageview');
        </script>
      {% endblock %}

      {% block ctstem %}
        <script type="text/javascript" src="/static/js/session.js"></script>
        <script type="text/javascript" src="/static/js/clone_more.js"></script>
        <script type="text/javascript" src="/static/js/ctstem.js"></script>
        <link rel="stylesheet" href="/static/css/ctstem.css" media="screen"/>
      {% endblock %}

      <!-- Plugin JavaScript -->
      {% block inlinejs %}
      <script type="text/javascript">
        $(function (){
          $("#formLogin").submit(function(e) {
            e.preventDefault();
            var data = $(this).serialize();
            var url = "{% url 'ctstem:login' %}";
            $.ajax({
              type: "POST",
              url: url,
              data: data,
              dataType: 'json',
              success: function(data){
                if(data['result'] == 'Success'){
                  //window.location = "{% url 'ctstem:home' %}";
                  window.location.reload();
                }
                else{
                  $('#loginMsg').html(data['message']);
                  $('#password').val('');
                }
              },
              error: function(xhr, ajaxOptions, thrownError){
                $('#loginMsg').html("Something went wrong.  Try again later!");
                $('#password').val('');
              },
            });
          });
          //check student session every 60 seconds
          {% if user.student %}
            setInterval(check_session, 60000);
          {% endif %}

          $('pre code').each(function(i, block) {
            hljs.highlightBlock(block);
          });
          {% if user.student or user.teacher %}
            var url = "{% url 'ctstem:load_consent' %}";
            $.ajax({
              type: "GET",
              url: url,
              dataType: 'json',
              success: function(data){
                if(data['load'] == true){
                  $("#consent").load("{% url 'ctstem:consent' %}", function() {
                    $(this).modal('show');
                  });
                }
              },
            });
          {% endif %}
        });
      </script>
      {% endblock %}
      {% block custom_media %}{% endblock %}
    {% endblock %}
  </head>

  <body id="page-top" class="index">
    {% block header %}
      <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
          <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="{% url 'ctstem:home' %}">CTSTEM</a>
          </div>
          <!-- Collect the nav links, forms, and other content for toggling -->
          <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
              {% if not user.student %}
                <li class="{% navactive request 'ctstem:curricula' 'lessons'%} "><a href="{% url 'ctstem:curricula' 'lessons' %}">Curricula</a></li>
                {% if user.is_authenticated%}
                  {% if user.administrator or user.researcher or user.author %}
                    <li class="{% navactive request 'ctstem:curricula' 'assessments' %} "><a href="{% url 'ctstem:curricula' 'assessments' %}">Assessments</a></li>
                    <li class="{% navactive request 'ctstem:standards' %} "><a href="{% url 'ctstem:standards' %}">Standards</a></li>
                  {% else %}
                    <li class="{% navactive request 'ctstem:curricula' 'assessments' %} "><a href="{% url 'ctstem:curricula' 'assessments' %}">Assessments</a></li>
                    <!--li><a href="http://ct-stem-assess.herokuapp.com/" target="_blank">Assessments</a></li-->
                    <li><a class="page-scroll" href="{% url 'ctstem:home' %}#practices">Standards</a></li>
                  {% endif %}

                  <li class="{% navactive request 'ctstem:publications' %}"><a href="{% url 'ctstem:publications' %}">Research</a></li>
                  {% if user.administrator %}
                    <li class="dropdown {% navactive request 'ctstem:training'%} {% navactive request 'ctstem:training_requests'%}">
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown" id="training">Training  <b class="caret"></b></a>
                      <ul class="dropdown-menu">
                        <li class="{% navactive request 'ctstem:training' %}"><a href="{% url 'ctstem:training' %}">Training Page</a></li>
                        <li class="{% navactive request 'ctstem:training_requests' %}"><a href="{% url 'ctstem:training_requests' %}">Training Requests</a></li>
                      </ul>
                    </li>
                  {% else %}
                    <li class="{% navactive request 'ctstem:training' %}"><a href="{% url 'ctstem:training' %}">Training</a></li>
                  {% endif %}
                  <li class="{% navactive request 'ctstem:team' %}"><a href="{% url 'ctstem:team' %}">Team</a></li>

                {% elif request.path == '/' %}
                  <li><a class="page-scroll" href="#assessments">Assessments</a></li>
                  <li><a class="page-scroll" href="#practices">Standards</a></li>
                  <li class="{% navactive request 'ctstem:publications' %}"><a href="{% url 'ctstem:publications' %}">Research</a></li>
                  <li class="{% navactive request 'ctstem:training' %}"><a href="{% url 'ctstem:training' %}">Training</a></li>
                  <li class="{% navactive request 'ctstem:team' %}"><a href="{% url 'ctstem:team' %}">Team</a></li>
                {% else %}
                  <li><a class="page-scroll" href="{% url 'ctstem:home' %}#assessments">Assessments</a></li>
                  <li><a class="page-scroll" href="{% url 'ctstem:home' %}#practices">Standards</a></li>
                  <li class="{% navactive request 'ctstem:publications' %}"><a href="{% url 'ctstem:publications' %}">Research</a></li>
                  <li class="{% navactive request 'ctstem:training' %}"><a href="{% url 'ctstem:training' %}">Training</a></li>
                  <li class="{% navactive request 'ctstem:team' %}"><a href="{% url 'ctstem:team' %}">Team</a></li>
                {% endif %}
              {% endif %}
              {% if user.student %}
                <li class="{% navactive request 'ctstem:assignments' 'inbox' %}"><a href="{% url 'ctstem:assignments' 'inbox' %}">My Assignments</a></li>
              {% endif %}

              {% if user.administrator or user.researcher or user.school_administrator %}
                <li class="dropdown {% navactive request 'ctstem:users' 'students' %} {% navactive request 'ctstem:users' 'teachers' %} {% navactive request 'ctstem:users' 'admins' %} {% navactive request 'ctstem:users' 'researchers' %} {% navactive request 'ctstem:users' 'authors' %} {% navactive request 'ctstem:groups' %}">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown" id="users">Users  <b class="caret"></b></a>
                  <ul class="dropdown-menu">
                    {% if user.administrator %}
                      <li class="{% navactive request 'ctstem:users' 'admins' %}"><a href="{% url 'ctstem:users' 'admins' %}">Site Admins</a></li>
                      <li class="{% navactive request 'ctstem:users' 'researchers' %}"><a href="{% url 'ctstem:users' 'researchers' %}">Researchers</a></li>
                      <li class="{% navactive request 'ctstem:users' 'authors' %}"><a href="{% url 'ctstem:users' 'authors' %}">Content Authors</a></li>
                    {% endif %}
                    {% if user.administrator or user.researcher %}
                      <li class="{% navactive request 'ctstem:users' 'school_administrators' %}"><a href="{% url 'ctstem:users' 'school_administrators' %}">School Administrators</a></li>
                    {% endif %}
                    {% if user.administrator or user.researcher or user.school_administrator%}
                      <li class="{% navactive request 'ctstem:users' 'teachers' %}"><a href="{% url 'ctstem:users' 'teachers' %}">Teachers</a></li>
                      <li class="{% navactive request 'ctstem:users' 'students' %}"><a href="{% url 'ctstem:users' 'students' %}">Students</a></li>
                      <li class="divider"></li>
                      <li class="{% navactive request 'ctstem:groups' %}"><a href="{% url 'ctstem:groups' %}">Groups</a></li>
                    {% endif %}
                  </ul>
                </li>
              {% elif user.teacher %}
                <li class="{% navactive request 'ctstem:groups' %}"><a href="{% url 'ctstem:groups' %}">My Groups</a></li>
              {% endif %}

              {% if user.administrator or user.researcher %}
                <li class="dropdown {% navactive request 'ctstem:subjects' %} {% navactive request 'ctstem:schools' %}">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown" id="metadata">Metadata<b class="caret"></b></a>
                  <ul class="dropdown-menu">
                    <li class="{% navactive request 'ctstem:subjects' %}"><a href="{% url 'ctstem:subjects' %}">Subjects</a></li>
                    <li class="{% navactive request 'ctstem:schools' %}"><a href="{% url 'ctstem:schools' %}">Schools</a></li>
                    {% if user.administrator %}
                      <li class="{% navactive request 'ctstem:teamMembers' %}"><a href="{% url 'ctstem:teamMembers' %}">Team</a></li>
                       <li class="{% navactive request 'ctstem:curricula' 'surveys' %} "><a href="{% url 'ctstem:curricula' 'surveys' %}">Surveys</a></li>
                    {% endif %}
                  </ul>
                </li>
              {% endif %}
            </ul>
            <ul class="nav navbar-nav navbar-right">
              {% block profile %}
                {% if user.is_authenticated %}
                  <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" id="welcome">
                      <span class="glyphicon glyphicon-user"></span>
                      <strong>{{ user.first_name}}</strong>
                      <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                      <li>
                        <div class="navbar-login">
                          <div class="row">
                            <div class="col-lg-4">
                              <p class="text-center">
                                <span class="glyphicon glyphicon-user icon-size"></span>
                              </p>
                            </div>
                            <div class="col-lg-8">
                              <p class="text-left"><a class="profile">{{user.get_full_name|title}}</a></p>
                              <p class="text-left small"><a class="profile">{{user.email}}</a></p>
                              <p class="text-left">
                                <a href="{% url 'ctstem:userProfile' user.id %}" class="btn btn-success btn-block btn-sm">Edit Profile</a>
                              </p>
                            </div>
                          </div>
                        </div>
                      </li>
                      <li class="divider"></li>
                      <li>
                        <div class="navbar-login navbar-login-session">
                          <div class="row">
                            <div class="col-lg-12">
                              <p>
                                <a href="{% url 'ctstem:logout' %}" class="btn btn-danger btn-block">Logout</a>
                              </p>
                            </div>
                          </div>
                        </div>
                      </li>
                    </ul>
                  </li>
                {% else %}
                  <li>
                    <a data-toggle="modal" data-target="#login" class="login" href="#">Login</a>
                  </li>
                {% endif %}
              {% endblock %}
            </ul>
          </div><!-- /.navbar-collapse -->
        </div><!-- /.container-fluid -->
      </nav>
    {% endblock %}

    {% block content %}
      <ul class="messages bg-light-gray">
        {% for message in messages %}
        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message|safe }}</li>
        {% endfor %}
      </ul>
    {% endblock %}
    {% block modals %}
      {% block login %}
        <div class="modal fade" id="login" role="dialog">
          <div class="modal-dialog modal-sm">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h3 class="modal-title">Login</h3>
              </div>
              <div id="loginMsg" class="msg">
              </div>
              <form class="form" id="formLogin" method="post">
                {% csrf_token %}
                <div class="modal-body">
                  <div class="form-group">
                    <label for="id_username">Username*</label>
                    <input name="username" id="username" type="text" class="form-control">
                  </div>
                  <div class="form-group">
                    <label for="id_password">Password*</label>
                    <input name="password" id="password" type="password" class="form-control">
                  </div>
                </div>
                <div class="modal-footer">
                  <div class="form-group button-row">
                    <button type="submit" id="btnLogin" class="btn btn-success">
                      <span class="glyphicon glyphicon-log-in" aria-hidden="true"></span>
                      Login
                    </button>
                    <a type="button" href="{% url 'ctstem:register' %}" class="btn btn-info">Register</a>
                  </div>
                  <div class="form-group button-row">
                    <a href="{% url 'password_reset_recover' %}">Forgot Password</a><br>
                    <a href="{% url 'ctstem:validate' %}">Validate Account</a>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      {% endblock %}
      {% block session_expiry %}
        <div class="modal fade" id="session_expiry" role="dialog">
          <div class="modal-dialog modal-sm">
            <div class="modal-content">
              <div class="modal-header">
                <h3 class="modal-title">Session Expiring</h3>
              </div>
              <div id="sessionMsg" class="msg">
              </div>
              <form class="form" id="formSession" method="post" action="{% url 'ctstem:check_session' %}">
                {% csrf_token %}
                <div class="modal-body">
                  <h5>Your session is expiring in <span class="time"></span> second(s)</h5>
                </div>
                <div class="modal-footer">
                  <div class="form-group button-row">
                    <button type="submit" id="btnSession" class="btn btn-success">
                      Keep Session
                    </button>
                    <a type="button" href="{% url 'ctstem:logout' %}" class="btn btn-warning">Logout</a>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      {% endblock %}

      <div class="modal fade" id="privacy" role="dialog">
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h3 class="modal-title">Privacy Policy</h3>
            </div>
            <div class="modal-body">
              <p>Privacy Policy Lorem ipsum</p>
            </div>
            <div class="modal-footer">
              <div class="form-group button-row">
                <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-times"></i> Close</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="modal fade" id="terms" role="dialog">
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h3 class="modal-title">Terms of Use</h3>
            </div>
            <div class="modal-body">
              <p>Curriculum materials on this site are licensed under a Creative Commons Attribution-Noncommercial-Share Alike 3.0 United States License subject to the following additional terms. The CT-STEM website and curriculum materials are distributed free of charge for non-commercial educational use. For any other uses of this website and materials, in original or modified form, including but not limited to distribution in whole or in part, specific prior permission must be obtained from the <a href="mailto:ct-stem@ccl.northwestern.edu">CT-STEM Project Investigators</a>. The website and curriculum materials shall not be used, rewritten, or adapted as the basis of a commercial software product or as part of course materials that are licensed or sold commercially without first obtaining appropriate licenses from Northwestern University. We make no representations about the suitability of this website for any purpose. It is provided "as is" without express or implied warranty.</p>
            </div>
            <div class="modal-footer">
              <div class="form-group button-row">
                <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="modal fade" id="funding" role="dialog">
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h3 class="modal-title">Funding Agencies</h3>
            </div>
            <div class="modal-body">
              <p>This work is supported by the National Science Foundation under NSF Grants CNS-1138461 and CNS-1441041 and by the Spencer Foundation. However, any opinions, findings, conclusions, and/or recommendations are those of the investigators and do not necessarily reflect the views of the funders.</p>
            </div>
            <div class="modal-footer">
              <div class="form-group button-row">
                <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-times"></i> Close</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal fade" id="curriculum" role="dialog">
      </div>
      <div class="modal fade" id="profile" role="dialog">
      </div>
      <div class="modal fade" id="consent" role="dialog" data-keyboard="false" data-backdrop="static"></div>
    {% endblock %}
  </body>

  {% block footer %}
    <footer>
      <div class="container">
        <div class="footer_content">
          All content and material (including lessons and assessments) copyright © 2016 CT-STEM Project. To inquire about using our material in your school or as part of research, please contact ct-stem@ccl.northwestern.edu.
        </div>
        <div class="footer_content">
          This work was made possible through generous support from the National Science Foundation (grants CNS-1138461 and CNS 1441041) and the Spencer Foundation (Award #201600069). Any opinions, findings, or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the funding organizations.
        </div>
        <div class="row footer_content">
          <div class="col-md-3">
            <b>Contact Us: </b><br>
            CT-STEM Project Investigators <br>
            Northwestern University<br>
            2120 Campus Drive<br>
            Evanston, Illinois 60208<br><br>

            ct-stem@ccl.northwestern.edu<br>
            http://ct-stem.northwestern.edu<br>
          </div>

          <div class="col-md-3">
            <img src="/static/img/nu-logo.png" class="img-responsive img-centered" style="opacity: 0;" alt="">
          </div>

          <div class="col-md-3">
            <img src="/static/img/NSFLogo.png" class="img-responsive img-centered" alt="">
          </div>

          <div class="col-md-3">
             <img src="/static/img/nu-logo.png" class="img-responsive img-centered" alt="">
          </div>
        </div>
      </div>
    </footer>
  {% endblock %}


</html>
