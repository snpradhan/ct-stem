{% extends "ctstem_app/base.html" %}

{% block media %}
  {{ block.super }}
  {{ form.media }}
{% endblock %}
{% block title %}User Groups |{% endblock %}

{% block content %}
  {{block.super}}
  <div class="content">
    <h2> User Groups </h2>

    <div class="btn-group">
      <a type="button" class="btn btn-primary" href="{% url 'ctstem:newGroup' %}" title="Create new group">Create Group</a>
    </div>

    {% if groups %}
      <table class="table table-striped dt" id="groups">
        <thead>
          <tr>
            <th> Title </th>
            <th> Subject </th>
            <th> Time </th>
            <th> Teacher </th>
            <th> Students </th>
            <th> Assignments </th>
          </tr>
          <tr id="filterrow">
            <th> Title </th>
            <th> Subject </th>
            <th> Time </th>
            <th> Teacher </th>
            <th> Students </th>
            <th> Assignments </th>
          </tr>
        </thead>
        <tbody>
          {% for group in groups %}
            <tr>
              <td class="title">
                {{group.title}}
                <a type="button" class="btn btn-default" aria-label="Edit Group" title="Edit Group" href="{% url 'ctstem:group' group.id %}">
                    <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                </a>
              </td>
              <td>{{group.subject}}</td>
              <td>{{group.time}}</td>
              <td>{{group.teacher}}</td>
              <td>
                {{group.members.count}}
                {% if group.members.count > 0 %}
                  <span class="expand_collapse">
                    <span class="glyphicon glyphicon-collapse-up" aria-hidden="true" style="display:none;"></span>
                    <span class="glyphicon glyphicon-collapse-down" aria-hidden="true"></span>
                  </span>
                  <div class="members" style="display:none;">
                    {% for member in group.members.all %}
                      {{member}}<br>
                    {% endfor %}
                  </div>
                {% endif %}

              </td>
              <td>
                {{group.assignments.count}}
                {% if group.assignments.count > 0 %}
                  <span class="expand_collapse">
                    <span class="glyphicon glyphicon-collapse-up" aria-hidden="true" style="display:none;"></span>
                    <span class="glyphicon glyphicon-collapse-down" aria-hidden="true"></span>
                  </span>
                  <div class="assignments" style="display:none;">
                    {% for assignment in group.assignments.all %}
                      {{assignment}} </br>
                    {% endfor %}
                  </div>
                {% endif %}
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p>No groups available.</p>
    {% endif %}
  </div>

  <script type="text/javascript">
    $(".expand_collapse").click(function(){
        $(this).next().toggle();
        $(this).children().each(function(){
          $(this).toggle();
        })
      });
  </script>

{% endblock %}


